<div class="container mt-5">

  <!-- Search and Sort Section -->
  <div class="card bg-transparent mb-5 p-4">
    <div class="row g-4 align-items-center">
      <!-- Search Input -->
      <div class="col-md-8">
        <label for="searchInput" class="form-label visually-hidden">Search products</label>
        <div class="input-group">
          <input
            type="text"
            class="form-control"
            id="searchInput"
            placeholder="Search for products..."
            [(ngModel)]="searchTerm"
            (keyup.enter)="onSearch()">
          <button class="btn btn-success" type="button" (click)="onSearch()">
            Search
          </button>
        </div>
      </div>

      <!-- Sort Dropdown -->
      <div class="col-md-4">
        <div class="d-flex align-items-center">
          <label for="sortBySelect" class="me-2 text-nowrap">Sort by:</label>
          <select class="form-select" id="sortBySelect" [(ngModel)]="sortBy" (change)="onSortChange()">
            <option value="latest">Latest</option>
            <option value="price_asc">Price: Ascending</option>
            <option value="price_desc">Price: Descending</option>
            <option value="alpha_asc">Alphabetical: A-Z</option>
            <option value="alpha_desc">Alphabetical: Z-A</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <h2 class="mb-4">For sale</h2>

  <div *ngIf="products.length === 0">
    <p>No products available</p>
  </div>

  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
    <div class="col" *ngFor="let product of products">
      <div class="product-card-uniform" [ngClass]="{'sold-out-card': product.quantity === 0}" (click)="goToProduct(product.productId)" style="cursor: pointer;">
        <div class="card-img-container">
          <app-image-carousel [images]="product.images || []"></app-image-carousel>
        </div>
        <div class="card-body">
          <h5 class="card-title text-truncate">{{ product.name }}</h5>
          <div class="card-text price-container">
            <ng-container *ngIf="product.quantity > 0; else soldOutPrice">
              {{ product.price | currency:'EUR':'symbol' }}
            </ng-container>
            <ng-template #soldOutPrice>
              <span class="original-price-strikethrough">{{ product.price | currency:'EUR':'symbol' }}</span>
              <span class="sold-out-label">Sold Out</span>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
